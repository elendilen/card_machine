# 卡片机器人控制系统 (Card Machine Robot)

## 项目概述

这是一个基于Arduino的卡片机器人控制系统，能够通过串口通信控制机器人的旋转和卡片弹射功能。该系统主要用于自动化卡片处理和精确定位操作。

## 主要功能

- **旋转控制**: 使用双舵机实现精确角度控制（0-180度）。注，由于两个舵机采用类似于串联的方式，所以合起来旋转角度为360度。这里效果较为一般，可以替换为步进电机，由于经费和材料限制我们没有做这样的优化。
- **卡片弹射**: 通过直流电机和传感器实现自动卡片弹射
- **串口通信**: 支持通过串口接收控制指令
- **模块化设计**: 分离的旋转模块和弹射模块，便于维护和扩展

## 硬件需求

### 必需组件
- Arduino开发板
- 2个舵机 (连接到引脚9和10)
- 1个直流电机 (使用AF Motor Shield)
- 1个模拟传感器 (连接到引脚15)
- Motor Shield扩展板

### 连接方式
- 舵机1: 引脚9
- 舵机2: 引脚10
- 直流电机: Motor Shield端口1
- 传感器: 模拟引脚15

## 文件结构

```
card_machine/
├── card_machine.ino          # 主程序文件
├── rotation_module.h         # 旋转模块头文件
├── rotation_module.cpp       # 旋转模块实现
├── ejector_module.h          # 弹射模块头文件
├── ejector_module.cpp        # 弹射模块实现
└── README.md                 # 说明文档
```

## 使用说明

### 1. 硬件设置
1. 按照连接方式图连接所有硬件组件
2. 确保Arduino连接到计算机
3. 上传代码到Arduino开发板

### 2. 串口通信协议

系统通过串口接收以下指令：

#### 基本指令
- `r` - 旋转一小步 (增量2度)
- `q` - 回到初始位置 (0度)
- `s <角度>` - 旋转到指定角度并弹射卡片
- `R <角度>` - 仅旋转到指定角度 (不弹射)

#### 指令格式示例
```
r           # 旋转一小步
s 45        # 旋转到45度并弹射卡片
R 90        # 旋转到90度
q           # 回到0度
```

### 3. 工作流程

典型的工作流程如下：
1. 发送 `r` 指令让机器人旋转90次 (完成一个循环)
2. 在特定角度发送弹射指令：
   - `s 0` - 0度弹射
   - `s 45` - 45度弹射
   - `s 90` - 90度弹射
   - `s 135` - 135度弹射

## 技术特点

### 旋转模块 (rotation_module)
- 使用双舵机同步控制，提高稳定性
- 支持0-180度精确角度控制
- 平滑的角度过渡 (每次2度增量)
- 当前角度状态记录

### 弹射模块 (ejector_module)
- 基于传感器反馈的智能弹射
- 阈值控制 (传感器值 < 400时工作)
- 自动停止机制，防止过度操作

## 依赖库

- `Servo.h` - 舵机控制库
- `AFMotor.h` - Adafruit电机控制库
- `Arduino.h` - Arduino核心库

## 安装步骤

1. 确保已安装Arduino IDE
2. 安装必需的库：
   ```
   - Servo库 (Arduino IDE自带)
   - AFMotor库 (Adafruit Motor Shield Library)
   ```
3. 克隆或下载项目文件
4. 使用Arduino IDE打开 `card_machine.ino`
5. 选择正确的开发板和串口
6. 上传代码到Arduino

## 注意事项

- 确保舵机角度在0-180度范围内
- 传感器阈值可能需要根据实际环境调整
- 建议在操作前测试各个模块的功能
- 注意电源供应能力，确保能够驱动所有组件

## 故障排除

1. **舵机不响应**: 检查连接线和电源
2. **弹射功能异常**: 检查传感器连接和阈值设置
3. **串口通信失败**: 确认波特率设置为9600
4. **角度不准确**: 检查舵机校准和机械结构

## 开发者信息

- 项目类型：Arduino嵌入式系统
- 开发语言：C++
- 硬件平台：Arduino + Motor Shield
- 通信协议：串口通信 (9600波特率)

## 许可证

本项目采用开源许可证，欢迎贡献代码和提出改进建议。
